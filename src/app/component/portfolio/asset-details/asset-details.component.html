<app-portfolio></app-portfolio>

<div id="asset-details-content">
    <div class="container-fluid">
        <h6 id="heading2">
            Asset - {{myAsset.symbol}}  - OVERVIEW 
            <button [routerLink]="['/portfolio/myPortfolio/addAsset', myAsset.symbol, myAsset.shares]" type="button" >
                    Trade
            </button>
        </h6>
        <div id="container">
            <div id="leftForm">
                <div id="heading">
                    CURRENT PRICE   ${{displayAsset.price}} PER SHARE   
                </div>  

                <!-- Update current asset price -->
                <label for="newPrice">New Price </label>
                <input type="number"          name="newPrice"      id="newPrice" placeholder="price per share" 
                        required               class="form-control" 
                        [(ngModel)]="newPrice" #symbol="ngModel"  >
                <button type="button" (click)="updatePrice(newPrice)">UPDATE PRICE</button>
                
                <!--Asset details table -->
                <table id="Margin1 tableClean">
                    <thead>
                        <tr>
                                <th></th>
                                <th>SHARES</th>
                                <th>AVG PRICE</th>
                                <th>CURRENT PRICE</th>
                                <th>CURRENT TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                                <td id="gold">CURRENT</td>
                                <td>{{displayAsset.shares}}</td>
                                <td>${{displayAsset.avgprice}}</td>
                                <td>${{displayAsset.price}}</td>
                                <td>${{displayAsset.currentTotal}}</td>
                        </tr>
                    </tbody>
                    <thead>
                        <tr>
                                <th></th>
                                <th>SOLD SHARES</th>
                                <th>AVG PRICE SOLD</th>
                                <th>TOTAL $ SOLD</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                                <td id="gold">SOLD</td>
                                <td>{{displayAsset.sharesSold}}</td>
                                <td>${{displayAsset.avgpriceSold}}</td>
                                <td>${{displayAsset.totalMoneyOut}}</td>
                        </tr>
                    </tbody>
                    <thead>
                        <tr>
                            <th></th>
                            <th>REALIZED</th>
                            <th>MARGIN</th>
                            <th>UNREALIZED</th>
                            <th>MARGIN</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr></tr>
                        <tr>
                            <td id="gold">PROFIT</td>
                            <td>${{displayAsset.realProfit}}</td>
                            <td>%{{displayAsset.realMargin}}</td>
                            <td>${{displayAsset.unRealProfit}}</td>
                            <td>%{{displayAsset.unRealMargin}}</td>
                        </tr>
                    </tbody>
                    <thead>
                        <tr>
                            <th></th>
                            <th>TOTAL $ INVESTED</th>
                            <th>TOTAL $ WITHDRAWN</th>
                            <th>ORIGINAL $ LEFT</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr></tr>
                        <tr>
                            <td id="gold">MORE INFROMATION</td>
                            <td>${{displayAsset.totalMoneyIn}}</td>
                            <td>${{displayAsset.totalMoneyOut}}</td>
                            <td>${{displayAsset.originalMoney}}</td>
                        </tr>
                    </tbody>
                </table>          

                <!--What if Scenario table -->
                <table id="Margin1">
                    <thead>
                        <tr>
                            <th></th>
                            <th id="heading">WHAT IF SCENARIO</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>What if I sold at this price right now?</td>      
                            <td>
                                <form #form="ngForm">
                                    <div class="form-group">
                                        <label for="whatIfPrice">Price</label>
                                        <input type="number"  name="whatIfPrice"              placeholder="price"  id="whatIfPrice"
                                                required       pattern="^\d{0,4}(\.\d{0,2})?$" class="form-control"
                                                [(ngModel)]="whatIf.whatIfPrice"               #whatIfPrice="ngModel"  >
                                        <div   [hidden]="whatIfPrice.valid || whatIfPrice.pristine"
                                                class="alert alert-danger">
                                                Invalid price
                                        </div>
                                    </div>
                                </form>
                            </td>
                            <td>
                                <button type="button" (click)="whatIfScenario(whatIfPrice)">WHAT IF?</button>
                            </td>
                        </tr>
                        <tr>
                            <td>Total Money I would Get</td>
                            <td>${{whatIf.totalMoneyOut}}</td>
                        </tr>
                        <tr>
                            <td>Pure Profit</td>
                            <td>${{whatIf.pureProfit}}</td>
                        </tr>
                        <tr>
                            <td>Margin</td>
                            <td>%{{whatIf.pureProfitMargin}}</td>
                        </tr>
                        <tr>
                            <td>HOW MANY SHARES DO I NEED TO SELL TO GET MY ORIGINAL MONEY BACK?</td>
                            <td>{{whatIf.sharesToSell}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!--Transaction History table -->
            <div id="rightForm">
                <ul class="nav justify-content-center">
                    <li class="nav-item">
                            <button (click)="displayTransactions('true')" style="color:whitesmoke; background-color:green">ONLY BOUGHT TRANSACTIONS</button>
                    </li>
                    <li class="nav-item">
                            <button (click)="displayTransactions('false')" style="color:whitesmoke; background-color:red">ONLY SOLD TRANSACTIONS</button>
                    </li>
                    <li class="nav-item">
                            <button (click)="displayTransactions('all')" style="color:black; background-color:whitesmoke" >ALL TRANSACTIONS</button>
                    </li>
                </ul>
                <p id="heading">MY TRANSACTIONS</p>
                <table id="tableClean">
                    <thead>
                    <tr>
                        <th>Shares</th>
                        <th>Price</th>
                        <th>Date</th>
                        <th>Total</th>
                        <th>Gain</th>
                    </tr>
                    </thead>
                    <tbody>    
                    <tbody>
                    <tbody>    
                        <tr *ngFor="let transaction of transactions" 
                            [style.background-color]="transaction.transaction == false ? 'red' : 'green'" 
                            style="color:white">  
                            <td> {{ transaction.shares }}</td>
                            <td>${{ transaction.price  }}</td>
                            <td> {{ transaction.buydate}}</td>   
                            <td>${{ transaction.total  }}</td>
                            <td> {{ transaction.total  }}%</td>
                            <br>
                        </tr>
                    </tbody>
                </table>
            </div>
    
        </div>    
    </div>
</div>